# Rivest, Shamir, Adleman
Author: [Xiaozhi](https://github.com/ChanTingHui)

## Description
RSA knowledge and RSA calculations

## Requirements 
- RSA understanding
- factordb
- Online decoder

## Sources

- [jayden.txt](https://github.com/ChanTingHui/wssqrctf/blob/main/crypto/Rivest%2C%20Shamir%2C%20Adleman/bin/jayden.txt)


```
 My friend Jayden have stolen one of our flags and changed the flag syntex. Recover it for me and change it back !
```


## Exploit

Explanation of formula of RSA : <br/>

n= A large Number generation for the algorithm
e= public key
c= cipher key 

n= p*q (factors of the number generation)

totient of n (phi) = (p-1) * (q-1)   (used as part of the formula)

private key(d) = highest common factor(e, phi )

message = pow(c, d , n)  

Example , message = ((cipher key * cipher key * cipher key) % n)) where * is the variable of private key , in this case
I am stating private key is 3)


Candidates are requied to crack the message hidden with the values using the understanding of RSA algorithm. The three values given to them. <br/>
N= (p*q) <br/>
e = RSA public exponent <br/>
c = cipher <br/>

Using the values, candidates are required to factorise the value of N to find the value of p and q and translate e to decimal for the decryption:
```
n = 23952937352643527451379227516428377705004894508566304313177880191662177061878993798938496818120987817049538365206671401938265663712351239785237507341311858383628932183083145614696585411921662992078376103990806989257289472590902167457302888198293135333083734504191910953238278860923153746261500759411620299864395158783509535039259714359526738924736952759753503357614939203434092075676169179112452620687731670534906069845965633455748606649062394293289967059348143206600765820021392608270528856238306849191113241355842396325210132358046616312901337987464473799040762271876389031455051640937681745409057246190498795697239

Searching the value of 0x10001 online will show e as the exponential value:

e = 65537
c = 
15051716337137612347434321952228426335495408393549777117255303538425511940440699962046478898040871513846980206440905856588723564812890378542295537785496526731361669985069979576741406438554782379859338512087010286331560106000530469318876645593258206686172117588140825213883401972821968724362412276968652347022257114668119138489426559574173407958649933777939722735529927193002027981256714469524539007686445725676540864441421047193691971374862300634461980360530460547178093671492442236987958322539936443313331216765227754697496644599077316980396835542386825047278208288901096883588942487867704810426319109808868595669927

```

Using factordb.com to find the factors:
![image](https://user-images.githubusercontent.com/69874238/124200250-6aeb6d80-db07-11eb-8386-34c917d1eac9.png)

p = 
153143042272527868798412612417204434156935146874282990942386694020462861918068684561281763577034706600608387699148071015194725533394126069826857182428660427818277378724977554365910231524827258160904493774748749088477328204812171935987088715261127321911849092207070653272176072509933245978935455542420691737433
<br>
q = 
156408916769576372285319235535320446340733908943564048157238512311891352879208957302116527435165097143521156600690562005797819820759620198602417583539668686152735534648541252847927334505648478214810780526425005943955838623325525300844493280040860604499838598837599791480284496210333200247148213274376422459183




<br/>


Using an online decoder to decrypter the message behind the numbers,
![image](https://user-images.githubusercontent.com/69874238/124200397-d2a1b880-db07-11eb-9d1d-39871b97f529.png)


Students can use kali and install additional packages to create a python script for an alternate solution. This is can be done using the following method:

sudo apt-get install build-essential python3-dev
pip install pycryptodomex


Created a python file named : rsa.py and craft the following python code :
![image](https://user-images.githubusercontent.com/69874238/124368888-6acea780-dc98-11eb-9869-9c50f1a14591.png)

run the code by using:

chmod +x rsa.py
./rsa.py 

The output:
<br>
![image](https://user-images.githubusercontent.com/69874238/124368949-10821680-dc99-11eb-96ae-de19aed20c6a.png)




Convert the flag syntex and enter the following:



The flag is:

```
wssqrctf{d0_y0u_kn0w_the_w@y_2_RS@_56yviuh}
```
